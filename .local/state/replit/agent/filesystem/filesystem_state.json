{"file_contents":{"src/components/TransactionList.tsx":{"content":"// src/components/TransactionList.tsx\n\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { Download, Edit2, Check, X } from \"lucide-react\";\nimport Papa from \"papaparse\";\n\nexport default function TransactionList({ refresh }: { refresh: boolean }) {\n  const [transactions, setTransactions] = useState<any[]>([]);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [editData, setEditData] = useState<any>({});\n\n  useEffect(() => {\n    async function fetchData() {\n      const res = await fetch(\"/api/transactions\");\n      const data = await res.json();\n      setTransactions(data);\n    }\n    fetchData();\n  }, [refresh]);\n\n  async function handleDelete(id: string) {\n    await fetch(\"/api/transactions\", {\n      method: \"DELETE\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ id }),\n    });\n    setTransactions((prev) => prev.filter((t) => t._id !== id));\n  }\n\n  function handleExportCSV() {\n    const csvData = transactions.map((tx) => ({\n      Date: new Date(tx.date).toLocaleDateString(),\n      Description: tx.description,\n      Category: tx.category,\n      Amount: tx.amount,\n      Recurring: tx.isRecurring ? \"Yes\" : \"No\",\n    }));\n\n    const csv = Papa.unparse(csvData);\n    const blob = new Blob([csv], { type: \"text/csv\" });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `transactions-${new Date().toISOString().split(\"T\")[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  }\n\n  function startEdit(tx: any) {\n    setEditingId(tx._id);\n    setEditData({\n      amount: tx.amount,\n      description: tx.description,\n      category: tx.category,\n      date: new Date(tx.date).toISOString().split(\"T\")[0],\n    });\n  }\n\n  async function saveEdit(id: string) {\n    const res = await fetch(\"/api/transactions\", {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ id, ...editData }),\n    });\n\n    if (res.ok) {\n      const updated = await res.json();\n      setTransactions((prev) =>\n        prev.map((t) => (t._id === id ? updated : t))\n      );\n      setEditingId(null);\n    }\n  }\n\n  function cancelEdit() {\n    setEditingId(null);\n    setEditData({});\n  }\n\n  if (!transactions.length) return <p className=\"p-4 text-gray-500 dark:text-gray-400\">No transactions yet.</p>;\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-lg font-semibold text-gray-800 dark:text-white\">Transaction History</h2>\n        <button\n          onClick={handleExportCSV}\n          className=\"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors\"\n        >\n          <Download className=\"w-4 h-4\" />\n          Export CSV\n        </button>\n      </div>\n      <ul className=\"space-y-2\">\n        {transactions.map((tx) => (\n          <li key={tx._id} className=\"flex justify-between items-center border dark:border-gray-700 p-3 rounded-lg bg-white dark:bg-gray-800\">\n            {editingId === tx._id ? (\n              <>\n                <input\n                  type=\"number\"\n                  value={editData.amount}\n                  onChange={(e) => setEditData({ ...editData, amount: e.target.value })}\n                  className=\"w-20 px-2 py-1 border rounded dark:bg-gray-700 dark:text-white dark:border-gray-600\"\n                />\n                <input\n                  type=\"text\"\n                  value={editData.description}\n                  onChange={(e) => setEditData({ ...editData, description: e.target.value })}\n                  className=\"flex-1 mx-2 px-2 py-1 border rounded dark:bg-gray-700 dark:text-white dark:border-gray-600\"\n                />\n                <select\n                  value={editData.category}\n                  onChange={(e) => setEditData({ ...editData, category: e.target.value })}\n                  className=\"px-2 py-1 border rounded dark:bg-gray-700 dark:text-white dark:border-gray-600\"\n                >\n                  <option value=\"Food\">Food</option>\n                  <option value=\"Rent\">Rent</option>\n                  <option value=\"Travel\">Travel</option>\n                  <option value=\"Shopping\">Shopping</option>\n                  <option value=\"Bills\">Bills</option>\n                  <option value=\"Other\">Other</option>\n                </select>\n                <input\n                  type=\"date\"\n                  value={editData.date}\n                  onChange={(e) => setEditData({ ...editData, date: e.target.value })}\n                  className=\"mx-2 px-2 py-1 border rounded dark:bg-gray-700 dark:text-white dark:border-gray-600\"\n                />\n                <div className=\"flex gap-2\">\n                  <button onClick={() => saveEdit(tx._id)} className=\"text-green-600 hover:text-green-700\">\n                    <Check className=\"w-5 h-5\" />\n                  </button>\n                  <button onClick={cancelEdit} className=\"text-red-600 hover:text-red-700\">\n                    <X className=\"w-5 h-5\" />\n                  </button>\n                </div>\n              </>\n            ) : (\n              <>\n                <div className=\"flex items-center gap-3 flex-1\">\n                  <span className=\"text-sm font-medium text-blue-500 dark:text-blue-400 min-w-[80px]\">\n                    {tx.category}\n                  </span>\n                  <div>\n                    <p className=\"font-medium text-gray-800 dark:text-white\">{tx.description}</p>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                      {new Date(tx.date).toDateString()}\n                      {tx.isRecurring && <span className=\"ml-2 text-xs bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-300 px-2 py-0.5 rounded\">Recurring</span>}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-4\">\n                  <p className=\"font-bold text-gray-800 dark:text-white\">₹{tx.amount}</p>\n                  <button\n                    onClick={() => startEdit(tx)}\n                    className=\"text-blue-600 dark:text-blue-400 hover:text-blue-700\"\n                    title=\"Edit\"\n                  >\n                    <Edit2 className=\"w-4 h-4\" />\n                  </button>\n                  <button\n                    onClick={() => handleDelete(tx._id)}\n                    className=\"text-red-600 dark:text-red-400 hover:underline\"\n                  >\n                    Delete\n                  </button>\n                </div>\n              </>\n            )}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n","size_bytes":6768},"tailwind.config.js":{"content":"","size_bytes":0},"README.md":{"content":"This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).\n\n## Getting Started\n\nFirst, run the development server:\n\n```bash\nnpm run dev\n# or\nyarn dev\n# or\npnpm dev\n# or\nbun dev\n```\n\nOpen [http://localhost:3000](http://localhost:3000) with your browser to see the result.\n\nYou can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.\n\nThis project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.\n\n## Learn More\n\nTo learn more about Next.js, take a look at the following resources:\n\n- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.\n- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.\n\nYou can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!\n\n## Deploy on Vercel\n\nThe easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.\n\nCheck out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.\n","size_bytes":1450},"src/app/api/auth/login/route.ts":{"content":"import { NextRequest, NextResponse } from \"next/server\";\nimport { connectToDatabase } from \"@/lib/db\";\nimport { User } from \"@/models/User\";\nimport { verifyPassword, generateToken, setAuthCookie } from \"@/lib/auth\";\n\nexport async function POST(req: NextRequest) {\n  try {\n    await connectToDatabase();\n    \n    const { email, password } = await req.json();\n    \n    if (!email || !password) {\n      return NextResponse.json(\n        { error: \"Email and password are required\" },\n        { status: 400 }\n      );\n    }\n    \n    const user = await User.findOne({ email });\n    if (!user) {\n      return NextResponse.json(\n        { error: \"Invalid credentials\" },\n        { status: 401 }\n      );\n    }\n    \n    const isValid = await verifyPassword(password, user.password);\n    if (!isValid) {\n      return NextResponse.json(\n        { error: \"Invalid credentials\" },\n        { status: 401 }\n      );\n    }\n    \n    const token = generateToken(user._id.toString());\n    await setAuthCookie(token);\n    \n    return NextResponse.json({\n      user: {\n        id: user._id,\n        email: user.email,\n        name: user.name,\n      },\n    });\n  } catch (error) {\n    console.error(\"Login error:\", error);\n    return NextResponse.json(\n      { error: \"Login failed\" },\n      { status: 500 }\n    );\n  }\n}\n","size_bytes":1299},"next.config.ts":{"content":"import type { NextConfig } from \"next\";\n\nconst nextConfig: NextConfig = {\n  /* config options here */\n};\n\nexport default nextConfig;\n","size_bytes":133},"src/components/AuthModal.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { useAuth } from \"@/contexts/AuthContext\";\n\nexport default function AuthModal() {\n  const [isLogin, setIsLogin] = useState(true);\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [error, setError] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const { login, register } = useAuth();\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setError(\"\");\n    setIsLoading(true);\n\n    try {\n      if (isLogin) {\n        await login(email, password);\n      } else {\n        if (!name) {\n          setError(\"Name is required\");\n          setIsLoading(false);\n          return;\n        }\n        await register(email, password, name);\n      }\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 px-4\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-8 w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-800 dark:text-white mb-2\">\n            Personal Finance Visualizer\n          </h1>\n          <p className=\"text-gray-600 dark:text-gray-300\">\n            {isLogin ? \"Welcome back!\" : \"Create your account\"}\n          </p>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {!isLogin && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                Name\n              </label>\n              <input\n                type=\"text\"\n                value={name}\n                onChange={(e) => setName(e.target.value)}\n                className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\n                required={!isLogin}\n              />\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Email\n            </label>\n            <input\n              type=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Password\n            </label>\n            <input\n              type=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\n              required\n              minLength={6}\n            />\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 p-3 rounded-lg text-sm\">\n              {error}\n            </div>\n          )}\n\n          <button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {isLoading ? \"Please wait...\" : isLogin ? \"Sign In\" : \"Sign Up\"}\n          </button>\n        </form>\n\n        <div className=\"mt-6 text-center\">\n          <button\n            onClick={() => {\n              setIsLogin(!isLogin);\n              setError(\"\");\n            }}\n            className=\"text-blue-600 dark:text-blue-400 hover:underline text-sm\"\n          >\n            {isLogin\n              ? \"Don't have an account? Sign up\"\n              : \"Already have an account? Sign in\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":4299},"src/app/api/auth/logout/route.ts":{"content":"import { NextResponse } from \"next/server\";\nimport { clearAuthCookie } from \"@/lib/auth\";\n\nexport async function POST() {\n  await clearAuthCookie();\n  return NextResponse.json({ message: \"Logged out successfully\" });\n}\n","size_bytes":219},"src/app/api/budgets/route.ts":{"content":"import { NextRequest, NextResponse } from \"next/server\";\nimport { connectToDatabase } from \"@/lib/db\";\nimport Budget from \"@/models/Budget\";\nimport { getUserIdFromRequest } from \"@/lib/auth\";\n\nexport async function GET() {\n  const userId = await getUserIdFromRequest();\n  if (!userId) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  await connectToDatabase();\n  const budgets = await Budget.find({ userId });\n  return NextResponse.json(budgets);\n}\n\nexport async function POST(req: NextRequest) {\n  const userId = await getUserIdFromRequest();\n  if (!userId) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const data = await req.json();\n  await connectToDatabase();\n  const budget = await Budget.findOneAndUpdate(\n    { userId, category: data.category, month: data.month },\n    { $set: { amount: data.amount, userId } },\n    { upsert: true, new: true }\n  );\n  return NextResponse.json(budget);\n}\n","size_bytes":966},"replit.md":{"content":"# Personal Finance Visualizer\n\n## Overview\n\nPersonal Finance Visualizer is a secure, multi-user Next.js web application that helps users track their expenses, set monthly budgets, and visualize spending patterns through interactive charts and insights. The application features user authentication, dark mode, CSV export, inline editing, recurring transactions, and real-time financial analytics to help users manage their personal finances effectively.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## Recent Changes (October 2025)\n\n### Authentication & Security\n- Implemented JWT-based authentication with bcrypt password hashing\n- Added user registration, login, and logout functionality\n- Protected all API routes with user authentication middleware\n- Multi-user support with data isolation per user\n\n### New Features\n- **Dark Mode**: System-sync dark mode using next-themes library\n- **CSV Export**: Download transaction history as CSV files\n- **Inline Editing**: Edit transactions directly in the list view\n- **Recurring Transactions**: Mark transactions as recurring with checkbox\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: Next.js 15.3.5 with React 19 and TypeScript\n- **Rendering Strategy**: Client-side rendering for interactive components using the \"use client\" directive\n- **Styling**: Tailwind CSS v4 with custom CSS variables for theming\n- **State Management**: Local component state using React hooks (useState, useEffect)\n- **UI Components**: Custom components with lucide-react icons for visual consistency\n\n**Component Structure**:\n- Page components in `src/app/` following Next.js App Router convention\n- Reusable UI components in `src/components/`\n- Real-time data refresh mechanism using a boolean toggle pattern passed as props\n\n**Key Design Decisions**:\n- Client-side data fetching in components for real-time updates\n- Prop-based refresh mechanism to trigger re-fetching across multiple components\n- Responsive design with mobile-first approach using Tailwind's grid system\n\n### Backend Architecture\n\n**Framework**: Next.js API Routes (serverless functions)\n- **API Pattern**: RESTful endpoints in `src/app/api/` directory\n- **Request Handling**: Native Next.js Request/Response objects\n- **Data Operations**: Standard CRUD operations (GET, POST, DELETE)\n\n**API Endpoints**:\n- `/api/auth/register` - User registration with email/password\n- `/api/auth/login` - User login with session creation\n- `/api/auth/logout` - User logout and session destruction\n- `/api/auth/user` - Get current authenticated user\n- `/api/transactions` - Manage financial transactions (GET, POST, PATCH, DELETE) - Protected\n- `/api/budgets` - Manage monthly budgets (GET, POST with upsert) - Protected\n\n**Key Design Decisions**:\n- Serverless architecture leveraging Next.js API routes for automatic scaling\n- Upsert pattern for budgets to prevent duplicate category-month combinations\n- JSON-based request/response format\n\n### Data Storage\n\n**Database**: MongoDB with Mongoose ODM\n- **Connection Management**: Cached connection pattern to prevent exhausting database connections in serverless environment\n- **Schema Design**: Two main models with simple, flat structures\n\n**Data Models**:\n\n*User Model*:\n- email (String, unique, required)\n- password (String, hashed with bcrypt, required)\n- name (String, required)\n- createdAt (Date)\n\n*Transaction Model*:\n- userId (String, required, indexed) - Links to User\n- amount (Number)\n- description (String)\n- date (Date)\n- category (Enum: Food, Rent, Travel, Shopping, Bills, Other)\n- isRecurring (Boolean, default: false)\n\n*Budget Model*:\n- userId (String, required, indexed) - Links to User\n- category (String)\n- amount (Number)\n- month (String, format: \"YYYY-MM\")\n\n**Key Design Decisions**:\n- Connection caching to reuse database connections across serverless invocations\n- Enum validation for transaction categories to ensure data consistency\n- Month stored as string for simplified querying and comparison\n- Mongoose models with conditional creation to prevent re-compilation errors in development\n\n### External Dependencies\n\n**Database Service**:\n- MongoDB (cloud or self-hosted) - Requires MONGODB_URI environment variable\n\n**Authentication**:\n- jsonwebtoken v9.x - JWT token generation and verification\n- bcryptjs v2.x - Password hashing and comparison\n- HTTP-only cookies for session management\n\n**Data Processing**:\n- papaparse v5.x - CSV generation and parsing for data export\n\n**UI Libraries**:\n- Recharts v3.0.2 - Bar, Pie, and Line charts with responsive containers\n- lucide-react v0.525.0 - Consistent iconography throughout the application\n- next-themes v0.x - System-sync dark mode support\n\n**CSS Framework**:\n- Tailwind CSS v4.1.11 with @tailwindcss/postcss plugin for styling\n- Autoprefixer for CSS compatibility\n- Dark mode support via Tailwind's dark: variants\n\n**Font Optimization**:\n- next/font with Geist and Geist Mono font families for optimized loading\n\n**Development Server**:\n- Configured to run on port 5000 with 0.0.0.0 host binding for Replit compatibility\n\n**Environment Variables Required**:\n- `MONGODB_URI` - MongoDB connection string (required)\n- `JWT_SECRET` - Secret key for JWT token signing (required, min 32 characters)","size_bytes":5259},"src/lib/db.ts":{"content":"// src/lib/db.ts\nimport mongoose from \"mongoose\";\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"\";\n\nif (!MONGODB_URI) {\n  throw new Error(\"Please define the MONGODB_URI environment variable\");\n}\n\ninterface GlobalWithMongoose {\n  mongoose?: { conn: typeof mongoose | null; promise: Promise<typeof mongoose> | null };\n}\n\nconst globalWithMongoose = global as GlobalWithMongoose;\nlet cached = globalWithMongoose.mongoose || { conn: null, promise: null };\n\nexport async function connectToDatabase() {\n  if (cached.conn) return cached.conn;\n  if (!cached.promise) {\n    cached.promise = mongoose.connect(MONGODB_URI, {\n      bufferCommands: false,\n    });\n  }\n  cached.conn = await cached.promise;\n  return cached.conn;\n}\n","size_bytes":719},"src/components/TransactionForm.tsx":{"content":"\"use client\";\nimport { useState } from \"react\";\nimport { PlusCircle } from \"lucide-react\";\n\nexport default function TransactionForm({ refresh }: { refresh: () => void }) {\n  const [amount, setAmount] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [date, setDate] = useState(\"\");\n  const [category, setCategory] = useState(\"\");\n  const [isRecurring, setIsRecurring] = useState(false);\n\n  const categories = [\"Food\", \"Rent\", \"Travel\", \"Shopping\", \"Bills\", \"Other\"];\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    if (!amount || !description || !date || !category)\n      return alert(\"Fill all fields\");\n\n    await fetch(\"/api/transactions\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        amount: Number(amount),\n        description,\n        date,\n        category,\n        isRecurring,\n      }),\n    });\n\n    setAmount(\"\");\n    setDescription(\"\");\n    setDate(\"\");\n    setCategory(\"\");\n    setIsRecurring(false);\n    refresh?.();\n  }\n\n  return (\n    <div className=\"p-6 rounded-lg border dark:border-gray-700 shadow-sm bg-white dark:bg-gray-800 space-y-4\">\n      <div className=\"flex items-center gap-2 mb-2\">\n        <PlusCircle className=\"text-blue-600 dark:text-blue-400\" />\n        <h2 className=\"text-xl font-semibold text-blue-700 dark:text-blue-400\">\n          Add New Transaction\n        </h2>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n              Amount (₹)\n            </label>\n            <input\n              type=\"number\"\n              value={amount}\n              onChange={(e) => setAmount(e.target.value)}\n              placeholder=\"Enter amount\"\n              className=\"mt-1 w-full p-2 border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n              Date\n            </label>\n            <input\n              type=\"date\"\n              value={date}\n              onChange={(e) => setDate(e.target.value)}\n              className=\"mt-1 w-full p-2 border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n            />\n          </div>\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n            Description\n          </label>\n          <input\n            type=\"text\"\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n            placeholder=\"E.g., Grocery shopping\"\n            className=\"mt-1 w-full p-2 border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n            Category\n          </label>\n          <select\n            value={category}\n            onChange={(e) => setCategory(e.target.value)}\n            className=\"mt-1 w-full p-2 border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n          >\n            <option value=\"\" disabled>\n              Select a category\n            </option>\n            {categories.map((cat) => (\n              <option key={cat} value={cat}>\n                {cat}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          <input\n            type=\"checkbox\"\n            id=\"recurring\"\n            checked={isRecurring}\n            onChange={(e) => setIsRecurring(e.target.checked)}\n            className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n          />\n          <label htmlFor=\"recurring\" className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n            Recurring transaction (monthly)\n          </label>\n        </div>\n\n        <div className=\"pt-2\">\n          <button\n            type=\"submit\"\n            className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded transition-all duration-200\"\n          >\n            Add Transaction\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n","size_bytes":4678},"src/components/DashboardSummary.tsx":{"content":"\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { ReceiptText, TrendingDown } from \"lucide-react\";\n\nexport default function DashboardSummary({ refresh }: { refresh: boolean }) {\n  const [total, setTotal] = useState(0);\n  const [recent, setRecent] = useState<any[]>([]);\n\n  useEffect(() => {\n    async function fetchData() {\n      const res = await fetch(\"/api/transactions\");\n      const txs = await res.json();\n      setTotal(txs.reduce((acc: number, tx: any) => acc + tx.amount, 0));\n      setRecent(txs.slice(0, 3)); // ✅ Show only top 3\n    }\n    fetchData();\n  }, [refresh]);\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 px-4 py-6\">\n      {/* Total Card */}\n      <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-lg shadow-md flex items-center gap-4\">\n        <ReceiptText className=\"w-10 h-10\" />\n        <div>\n          <h3 className=\"text-sm uppercase tracking-wide font-medium\">Total Expenses</h3>\n          <p className=\"text-3xl font-bold mt-1\">₹{total}</p>\n        </div>\n      </div>\n\n      {/* Recent Transactions Card */}\n      <div className=\"bg-white dark:bg-gray-800 col-span-2 p-6 rounded-lg shadow-md\">\n        <div className=\"flex items-center gap-2 mb-3\">\n          <TrendingDown className=\"text-rose-500 dark:text-rose-400\" />\n          <h3 className=\"text-lg font-semibold text-gray-800 dark:text-white\">Recent Transactions</h3>\n        </div>\n\n        {recent.length === 0 ? (\n          <p className=\"text-gray-500 dark:text-gray-400 text-sm\">No recent transactions</p>\n        ) : (\n          <ul className=\"divide-y divide-gray-100 dark:divide-gray-700 text-sm\">\n            {recent.map((tx) => (\n              <li\n                key={tx._id}\n                className=\"flex justify-between items-center py-2 text-gray-700 dark:text-gray-300\"\n              >\n                <div>\n                  <p className=\"font-medium\">{tx.description}</p>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                    {new Date(tx.date).toLocaleDateString()}\n                  </span>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"font-semibold\">₹{tx.amount}</p>\n                  <span className=\"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-full\">\n                    {tx.category}\n                  </span>\n                </div>\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":2562},"src/components/BudgetVsActualChart.tsx":{"content":"\"use client\";\nimport { useEffect, useState } from \"react\";\nimport {\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  Tooltip,\n  ResponsiveContainer,\n  CartesianGrid,\n  Legend,\n} from \"recharts\";\nimport { RefreshCcw, Scale3D } from \"lucide-react\";\n\nexport default function BudgetVsActualChart({ refresh }: { refresh: boolean }) {\n  const [chartData, setChartData] = useState([]);\n\n  useEffect(() => {\n    async function fetchData() {\n      const resTx = await fetch(\"/api/transactions\");\n      const txs = await resTx.json();\n\n      const resBudgets = await fetch(\"/api/budgets\");\n      const budgets = await resBudgets.json();\n\n      const currentMonth = new Date().toISOString().slice(0, 7);\n      const categoryTotals: Record<string, number> = {};\n\n      txs.forEach((tx: any) => {\n        const txMonth = new Date(tx.date).toISOString().slice(0, 7);\n        if (txMonth === currentMonth) {\n          categoryTotals[tx.category] =\n            (categoryTotals[tx.category] || 0) + tx.amount;\n        }\n      });\n\n      const data = budgets\n        .filter((b: any) => b.month === currentMonth)\n        .map((b: any) => ({\n          category: b.category,\n          budget: b.amount,\n          spent: categoryTotals[b.category] || 0,\n        }));\n\n      setChartData(data);\n    }\n\n    fetchData();\n  }, [refresh]);\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-md p-6 w-full h-[320px]\">\n      <div className=\"flex items-center gap-2 mb-4\">\n        <Scale3D className=\"text-emerald-600\" />\n        <h3 className=\"text-lg font-semibold text-gray-700\">\n          Budget vs Actual (This Month)\n        </h3>\n      </div>\n\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <BarChart data={chartData} barCategoryGap={20}>\n          <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n          <XAxis dataKey=\"category\" className=\"text-sm\" />\n          <YAxis className=\"text-sm\" />\n          <Tooltip\n            formatter={(value: number, name: string) =>\n              [`₹${value.toLocaleString()}`, name === \"spent\" ? \"Spent\" : \"Budget\"]\n            }\n            contentStyle={{ backgroundColor: \"white\", border: \"1px solid #ccc\" }}\n          />\n          <Legend />\n          <Bar\n            dataKey=\"budget\"\n            fill=\"#34d399\"\n            radius={[4, 4, 0, 0]}\n            name=\"Budget\"\n          />\n          <Bar\n            dataKey=\"spent\"\n            fill=\"#f87171\"\n            radius={[4, 4, 0, 0]}\n            name=\"Spent\"\n          />\n        </BarChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n","size_bytes":2541},"src/components/CategoryChart.tsx":{"content":"\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { PieChart, Pie, Cell, Tooltip, ResponsiveContainer } from \"recharts\";\n\nconst COLORS = [\"#8884d8\", \"#82ca9d\", \"#ffc658\", \"#f87171\", \"#a78bfa\", \"#38bdf8\"];\n\nexport default function CategoryChart({ refresh }: { refresh: boolean }) {\n  const [data, setData] = useState<{ name: string; value: number }[]>([]);\n\n  useEffect(() => {\n    async function fetchData() {\n      const res = await fetch(\"/api/transactions\");\n      const txs = await res.json();\n      const categoryMap: Record<string, number> = {};\n\n      txs.forEach((tx: { category: string; amount: number }) => {\n        categoryMap[tx.category] = (categoryMap[tx.category] || 0) + tx.amount;\n      });\n\n      const chartData = Object.keys(categoryMap).map((cat) => ({\n        name: cat,\n        value: categoryMap[cat],\n      }));\n\n      setData(chartData);\n    }\n    fetchData();\n  }, [refresh]);\n\n  return (\n    <div className=\"h-64 w-full p-4\">\n      <ResponsiveContainer>\n        <PieChart>\n          <Pie\n            data={data}\n            dataKey=\"value\"\n            nameKey=\"name\"\n            cx=\"50%\"\n            cy=\"50%\"\n            outerRadius={80}\n            fill=\"#8884d8\"\n            label\n          >\n            {data.map((_, index) => (\n              <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n            ))}\n          </Pie>\n          <Tooltip />\n        </PieChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n","size_bytes":1482},"src/components/BudgetForm.tsx":{"content":"\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { Wallet } from \"lucide-react\";\n\nconst categories = [\"Food\", \"Rent\", \"Travel\", \"Shopping\", \"Bills\", \"Other\"];\n\nexport default function BudgetForm({ refresh }: { refresh: boolean }) {\n  const [category, setCategory] = useState(\"Food\");\n  const [amount, setAmount] = useState(\"\");\n  const [currentMonth, setCurrentMonth] = useState<string | null>(null);\n\n  // Safely calculate current month on client\n  useEffect(() => {\n    const now = new Date().toISOString().slice(0, 7); // yyyy-mm\n    setCurrentMonth(now);\n  }, [refresh]);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    if (!amount || !currentMonth) return alert(\"Enter all fields\");\n\n    await fetch(\"/api/budgets\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        category,\n        amount: Number(amount),\n        month: currentMonth,\n      }),\n    });\n\n    setAmount(\"\");\n    // onUpdate();\n  }\n\n  if (!currentMonth) return null; // or return a skeleton/loader\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6\">\n      <div className=\"flex items-center gap-2 mb-4\">\n        <Wallet className=\"text-green-600 dark:text-green-400\" />\n        <h3 className=\"text-lg font-semibold text-gray-800 dark:text-white\">Set Monthly Budget</h3>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            Category\n          </label>\n          <select\n            value={category}\n            onChange={(e) => setCategory(e.target.value)}\n            className=\"w-full p-2 border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-green-500 dark:bg-gray-700 dark:text-white\"\n          >\n            {categories.map((cat) => (\n              <option key={cat} value={cat}>\n                {cat}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            Budget Amount (₹)\n          </label>\n          <input\n            type=\"number\"\n            placeholder=\"e.g., 5000\"\n            value={amount}\n            onChange={(e) => setAmount(e.target.value)}\n            className=\"w-full p-2 border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-green-500 dark:bg-gray-700 dark:text-white\"\n          />\n        </div>\n\n        <button\n          type=\"submit\"\n          className=\"w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded transition-all\"\n        >\n          Save Budget\n        </button>\n      </form>\n    </div>\n  );\n}\n","size_bytes":2807},"src/app/api/transactions/route.ts":{"content":"// src/app/api/transactions/route.ts\nimport { NextRequest, NextResponse } from \"next/server\";\nimport { connectToDatabase } from \"@/lib/db\";\nimport Transaction from \"@/models/Transaction\";\nimport { getUserIdFromRequest } from \"@/lib/auth\";\n\nexport async function GET() {\n  const userId = await getUserIdFromRequest();\n  if (!userId) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  await connectToDatabase();\n  const transactions = await Transaction.find({ userId }).sort({ date: -1 });\n  return NextResponse.json(transactions);\n}\n\nexport async function POST(req: NextRequest) {\n  const userId = await getUserIdFromRequest();\n  if (!userId) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const data = await req.json();\n  await connectToDatabase();\n  const transaction = await Transaction.create({ ...data, userId });\n  return NextResponse.json(transaction);\n}\n\nexport async function PATCH(req: NextRequest) {\n  const userId = await getUserIdFromRequest();\n  if (!userId) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { id, ...updates } = await req.json();\n  await connectToDatabase();\n  const transaction = await Transaction.findOneAndUpdate(\n    { _id: id, userId },\n    { $set: updates },\n    { new: true }\n  );\n  \n  if (!transaction) {\n    return NextResponse.json({ error: \"Transaction not found\" }, { status: 404 });\n  }\n  \n  return NextResponse.json(transaction);\n}\n\nexport async function DELETE(req: NextRequest) {\n  const userId = await getUserIdFromRequest();\n  if (!userId) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { id } = await req.json();\n  await connectToDatabase();\n  await Transaction.findOneAndDelete({ _id: id, userId });\n  return NextResponse.json({ success: true });\n}\n","size_bytes":1849},"src/app/api/auth/user/route.ts":{"content":"import { NextResponse } from \"next/server\";\nimport { connectToDatabase } from \"@/lib/db\";\nimport { User } from \"@/models/User\";\nimport { getUserIdFromRequest } from \"@/lib/auth\";\n\nexport async function GET() {\n  try {\n    const userId = await getUserIdFromRequest();\n    \n    if (!userId) {\n      return NextResponse.json(\n        { error: \"Not authenticated\" },\n        { status: 401 }\n      );\n    }\n    \n    await connectToDatabase();\n    const user = await User.findById(userId).select(\"-password\");\n    \n    if (!user) {\n      return NextResponse.json(\n        { error: \"User not found\" },\n        { status: 404 }\n      );\n    }\n    \n    return NextResponse.json({\n      id: user._id,\n      email: user.email,\n      name: user.name,\n    });\n  } catch (error) {\n    console.error(\"User fetch error:\", error);\n    return NextResponse.json(\n      { error: \"Failed to fetch user\" },\n      { status: 500 }\n    );\n  }\n}\n","size_bytes":919},"src/contexts/AuthContext.tsx":{"content":"\"use client\";\n\nimport { createContext, useContext, useEffect, useState } from \"react\";\n\ninterface User {\n  id: string;\n  email: string;\n  name: string;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  isLoading: boolean;\n  login: (email: string, password: string) => Promise<void>;\n  register: (email: string, password: string, name: string) => Promise<void>;\n  logout: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  async function checkAuth() {\n    try {\n      const res = await fetch(\"/api/auth/user\");\n      if (res.ok) {\n        const userData = await res.json();\n        setUser(userData);\n      }\n    } catch (error) {\n      console.error(\"Auth check failed:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  async function login(email: string, password: string) {\n    const res = await fetch(\"/api/auth/login\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ email, password }),\n    });\n\n    if (!res.ok) {\n      const data = await res.json();\n      throw new Error(data.error || \"Login failed\");\n    }\n\n    const data = await res.json();\n    setUser(data.user);\n  }\n\n  async function register(email: string, password: string, name: string) {\n    const res = await fetch(\"/api/auth/register\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ email, password, name }),\n    });\n\n    if (!res.ok) {\n      const data = await res.json();\n      throw new Error(data.error || \"Registration failed\");\n    }\n\n    const data = await res.json();\n    setUser(data.user);\n  }\n\n  async function logout() {\n    await fetch(\"/api/auth/logout\", { method: \"POST\" });\n    setUser(null);\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, isLoading, login, register, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within AuthProvider\");\n  }\n  return context;\n}\n","size_bytes":2329},"src/components/MonthlyChart.tsx":{"content":"\"use client\";\nimport { useEffect, useState } from \"react\";\nimport {\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  Tooltip,\n  ResponsiveContainer,\n  CartesianGrid,\n} from \"recharts\";\nimport { CalendarDays } from \"lucide-react\";\n\nexport default function MonthlyChart({ refresh }: { refresh: boolean }) {\n  const [data, setData] = useState<{ month: string; amount: number }[]>([]);\n\n  useEffect(() => {\n    async function fetchData() {\n      const res = await fetch(\"/api/transactions\");\n      const txs = await res.json();\n      const monthly = Array(12).fill(0);\n\n      txs.forEach((tx: any) => {\n        const month = new Date(tx.date).getMonth();\n        monthly[month] += tx.amount;\n      });\n\n      setData(\n        monthly.map((val, idx) => ({\n          month: new Date(0, idx).toLocaleString(\"default\", { month: \"short\" }),\n          amount: val,\n        }))\n      );\n    }\n    fetchData();\n  }, [refresh]);\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-md p-6 h-full\">\n      <div className=\"flex items-center gap-2 mb-4\">\n        <CalendarDays className=\"text-blue-500\" />\n        <h3 className=\"text-lg font-semibold text-gray-700\">Monthly Expenses</h3>\n      </div>\n\n      <ResponsiveContainer width=\"100%\" height={220}>\n        <BarChart data={data}>\n          <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n          <XAxis dataKey=\"month\" className=\"text-sm\" />\n          <YAxis className=\"text-sm\" />\n          <Tooltip\n            contentStyle={{ backgroundColor: \"white\", border: \"1px solid #ddd\" }}\n            formatter={(value: number) => `₹${value.toLocaleString()}`}\n          />\n          <Bar\n            dataKey=\"amount\"\n            fill=\"#3b82f6\"\n            radius={[4, 4, 0, 0]}\n            barSize={28}\n          />\n        </BarChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n","size_bytes":1827},"src/models/User.ts":{"content":"import mongoose, { Schema, models } from \"mongoose\";\n\nconst UserSchema = new Schema({\n  email: {\n    type: String,\n    required: true,\n    unique: true,\n    lowercase: true,\n    trim: true,\n  },\n  password: {\n    type: String,\n    required: true,\n  },\n  name: {\n    type: String,\n    required: true,\n    trim: true,\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n});\n\nexport const User = models.User || mongoose.model(\"User\", UserSchema);\n","size_bytes":456},"src/lib/auth.ts":{"content":"import jwt from \"jsonwebtoken\";\nimport bcrypt from \"bcryptjs\";\nimport { cookies } from \"next/headers\";\n\nconst JWT_SECRET = process.env.JWT_SECRET;\n\nif (!JWT_SECRET) {\n  throw new Error(\"JWT_SECRET environment variable is required for authentication\");\n}\n\nconst TOKEN_NAME = \"auth_token\";\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 10);\n}\n\nexport async function verifyPassword(\n  password: string,\n  hashedPassword: string\n): Promise<boolean> {\n  return bcrypt.compare(password, hashedPassword);\n}\n\nexport function generateToken(userId: string): string {\n  return jwt.sign({ userId }, JWT_SECRET as string, { expiresIn: \"7d\" });\n}\n\nexport function verifyToken(token: string): { userId: string } | null {\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET as string);\n    if (typeof decoded === 'object' && decoded !== null && 'userId' in decoded) {\n      return decoded as { userId: string };\n    }\n    return null;\n  } catch {\n    return null;\n  }\n}\n\nexport async function getUserIdFromRequest(): Promise<string | null> {\n  const cookieStore = await cookies();\n  const token = cookieStore.get(TOKEN_NAME)?.value;\n  \n  if (!token) return null;\n  \n  const decoded = verifyToken(token);\n  return decoded?.userId || null;\n}\n\nexport async function setAuthCookie(token: string) {\n  const cookieStore = await cookies();\n  cookieStore.set(TOKEN_NAME, token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    maxAge: 60 * 60 * 24 * 7, // 7 days\n    path: \"/\",\n  });\n}\n\nexport async function clearAuthCookie() {\n  const cookieStore = await cookies();\n  cookieStore.delete(TOKEN_NAME);\n}\n","size_bytes":1692},"src/models/Transaction.ts":{"content":"// src/models/Transaction.ts\nimport mongoose from \"mongoose\";\n\nconst TransactionSchema = new mongoose.Schema({\n  userId: {\n    type: String,\n    required: true,\n    index: true,\n  },\n  amount: Number,\n  description: String,\n  date: Date,\n  category: {\n    type: String,\n    enum: [\"Food\", \"Rent\", \"Travel\", \"Shopping\", \"Bills\", \"Other\"],\n    default: \"Other\",\n  },\n  isRecurring: {\n    type: Boolean,\n    default: false,\n  },\n});\n\n\nexport default mongoose.models.Transaction ||\n  mongoose.model(\"Transaction\", TransactionSchema);\n","size_bytes":530},"src/models/Budget.ts":{"content":"import mongoose from \"mongoose\";\n\nconst BudgetSchema = new mongoose.Schema({\n  userId: {\n    type: String,\n    required: true,\n    index: true,\n  },\n  category: { type: String, required: true },\n  amount: { type: Number, required: true },\n  month: { type: String, required: true }, // \"2025-07\"\n});\n\nexport default mongoose.models.Budget || mongoose.model(\"Budget\", BudgetSchema);\n","size_bytes":381},"src/app/layout.tsx":{"content":"import type { Metadata } from \"next\";\nimport { Geist, Geist_Mono } from \"next/font/google\";\nimport \"./globals.css\";\nimport { AuthProvider } from \"@/contexts/AuthContext\";\nimport { ThemeProvider } from \"next-themes\";\n\nconst geistSans = Geist({\n  variable: \"--font-geist-sans\",\n  subsets: [\"latin\"],\n});\n\nconst geistMono = Geist_Mono({\n  variable: \"--font-geist-mono\",\n  subsets: [\"latin\"],\n});\n\nexport const metadata: Metadata = {\n  title: \"Personal Finance Visualizer\",\n  description: \"Track your expenses, budgets, and insights with ease\",\n};\n\nexport default function RootLayout({\n  children,\n}: Readonly<{\n  children: React.ReactNode;\n}>) {\n  return (\n    <html lang=\"en\" suppressHydrationWarning>\n      <body\n        className={`${geistSans.variable} ${geistMono.variable} antialiased`}\n      >\n        <ThemeProvider attribute=\"class\" defaultTheme=\"system\" enableSystem>\n          <AuthProvider>\n            {children}\n          </AuthProvider>\n        </ThemeProvider>\n      </body>\n    </html>\n  );\n}\n","size_bytes":1007},"src/app/api/auth/register/route.ts":{"content":"import { NextRequest, NextResponse } from \"next/server\";\nimport { connectToDatabase } from \"@/lib/db\";\nimport { User } from \"@/models/User\";\nimport { hashPassword, generateToken, setAuthCookie } from \"@/lib/auth\";\n\nexport async function POST(req: NextRequest) {\n  try {\n    await connectToDatabase();\n    \n    const { email, password, name } = await req.json();\n    \n    if (!email || !password || !name) {\n      return NextResponse.json(\n        { error: \"All fields are required\" },\n        { status: 400 }\n      );\n    }\n    \n    const existingUser = await User.findOne({ email });\n    if (existingUser) {\n      return NextResponse.json(\n        { error: \"User already exists\" },\n        { status: 400 }\n      );\n    }\n    \n    const hashedPassword = await hashPassword(password);\n    const user = await User.create({\n      email,\n      password: hashedPassword,\n      name,\n    });\n    \n    const token = generateToken(user._id.toString());\n    await setAuthCookie(token);\n    \n    return NextResponse.json({\n      user: {\n        id: user._id,\n        email: user.email,\n        name: user.name,\n      },\n    });\n  } catch (error) {\n    console.error(\"Registration error:\", error);\n    return NextResponse.json(\n      { error: \"Registration failed\" },\n      { status: 500 }\n    );\n  }\n}\n","size_bytes":1292},"src/app/globals.css":{"content":"@import \"tailwindcss\";\n\n:root {\n  --background: #ffffff;\n  /* --foreground: #171717; */\n}\n\n@theme inline {\n  --color-background: var(--background);\n  --color-foreground: var(--foreground);\n  --font-sans: var(--font-geist-sans);\n  --font-mono: var(--font-geist-mono);\n}\n\n@media (prefers-color-scheme: light) {\n  :root {\n    --background: #ededed;\n    --foreground: #ededed;\n  }\n}\n\nbody {\n  background: var(--background);\n  color: var(--foreground);\n  font-family: Arial, Helvetica, sans-serif;\n}\n\n","size_bytes":496},"src/app/page.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport AuthModal from \"@/components/AuthModal\";\nimport TransactionForm from \"@/components/TransactionForm\";\nimport TransactionList from \"@/components/TransactionList\";\nimport MonthlyChart from \"@/components/MonthlyChart\";\nimport CategoryChart from \"@/components/CategoryChart\";\nimport DashboardSummary from \"@/components/DashboardSummary\";\nimport BudgetForm from \"@/components/BudgetForm\";\nimport BudgetVsActualChart from \"@/components/BudgetVsActualChart\";\nimport SpendingInsights from \"@/components/SpendingInsights\";\nimport { LineChart, PlusCircle, ClipboardList, Wallet, LogOut, Moon, Sun } from \"lucide-react\";\nimport { useTheme } from \"next-themes\";\n\nexport default function Home() {\n  const [refresh, setRefresh] = useState(false);\n  const { user, isLoading, logout } = useAuth();\n  const { theme, setTheme } = useTheme();\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900\">\n        <div className=\"text-xl text-gray-600 dark:text-gray-300\">Loading...</div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return <AuthModal />;\n  }\n\n  return (\n    <main className=\"max-w-6xl mx-auto py-8 px-4 space-y-10 bg-white dark:bg-gray-900 min-h-screen transition-colors\">\n      {/* Header */}\n      <header className=\"space-y-4\">\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-4xl font-bold text-gray-800 dark:text-white\">\n              Personal Finance Visualizer\n            </h1>\n            <p className=\"text-gray-600 dark:text-gray-400 text-sm mt-1\">\n              Welcome back, {user.name}!\n            </p>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <button\n              onClick={() => setTheme(theme === \"dark\" ? \"light\" : \"dark\")}\n              className=\"p-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors\"\n              aria-label=\"Toggle theme\"\n            >\n              {theme === \"dark\" ? (\n                <Sun className=\"w-5 h-5 text-yellow-500\" />\n              ) : (\n                <Moon className=\"w-5 h-5 text-gray-700\" />\n              )}\n            </button>\n            <button\n              onClick={logout}\n              className=\"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors\"\n            >\n              <LogOut className=\"w-4 h-4\" />\n              Logout\n            </button>\n          </div>\n        </div>\n        <p className=\"text-gray-600 dark:text-gray-400 text-sm text-center\">\n          Track your expenses, budgets, and insights with ease\n        </p>\n      </header>\n\n      {/* Overview Summary */}\n      <section className=\"space-y-4\">\n        <div className=\"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2\">\n          <LineChart className=\"text-blue-500 dark:text-blue-400\" />\n          <h2 className=\"text-xl font-semibold\">Overview</h2>\n        </div>\n        <DashboardSummary refresh={refresh}/>\n        <SpendingInsights refresh={refresh}/>\n      </section>\n\n      {/* Add Transaction */}\n      <section className=\"space-y-4\">\n        <div className=\"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2\">\n          <PlusCircle className=\"text-green-600 dark:text-green-400\" />\n          <h2 className=\"text-xl font-semibold\">Add Transaction</h2>\n        </div>\n        <TransactionForm refresh={() => setRefresh(!refresh)} />\n      </section>\n\n      {/* Charts Section */}\n      <section className=\"space-y-4\">\n        <div className=\"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2\">\n          <LineChart className=\"text-purple-600 dark:text-purple-400\" />\n          <h2 className=\"text-xl font-semibold\">Analytics</h2>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <MonthlyChart refresh={refresh}/>\n          <CategoryChart refresh={refresh} />\n        </div>\n      </section>\n\n      {/* Transaction History */}\n      <section className=\"space-y-4\">\n        <div className=\"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2\">\n          <ClipboardList className=\"text-gray-600 dark:text-gray-400\" />\n          <h2 className=\"text-xl font-semibold\">Transaction History</h2>\n        </div>\n        <TransactionList refresh={refresh} />\n      </section>\n\n      {/* Budget Tools */}\n      <section className=\"space-y-4\">\n        <div className=\"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2\">\n          <Wallet className=\"text-emerald-600 dark:text-emerald-400\" />\n          <h2 className=\"text-xl font-semibold\">Budget Planning</h2>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <BudgetForm refresh={refresh} />\n          <BudgetVsActualChart refresh={refresh} />\n        </div>\n      </section>\n    </main>\n  );\n}\n","size_bytes":4996},"src/components/SpendingInsights.tsx":{"content":"\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { AlertTriangle, Hourglass, CheckCircle } from \"lucide-react\";\n\ntype Insight = {\n  category: string;\n  status: \"over\" | \"near\" | \"under\";\n  message: string;\n  spent: number;\n  budget: number;\n};\n\nexport default function SpendingInsights({ refresh }: { refresh: boolean }) {\n  const [insights, setInsights] = useState<Insight[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    async function fetchData() {\n      const resTx = await fetch(\"/api/transactions\");\n      const txs = await resTx.json();\n\n      const resBudgets = await fetch(\"/api/budgets\");\n      const budgets = await resBudgets.json();\n\n      const currentMonth = new Date().toISOString().slice(0, 7);\n      const categoryTotals: Record<string, number> = {};\n\n      txs.forEach((tx: any) => {\n        const txMonth = new Date(tx.date).toISOString().slice(0, 7);\n        if (txMonth === currentMonth) {\n          categoryTotals[tx.category] =\n            (categoryTotals[tx.category] || 0) + tx.amount;\n        }\n      });\n\n      const results: Insight[] = budgets.map((b: any) => {\n        const spent = categoryTotals[b.category] || 0;\n        const remaining = b.amount - spent;\n\n        let status: Insight[\"status\"];\n        if (spent > b.amount) {\n          status = \"over\";\n        } else if (remaining <= 200) {\n          status = \"near\";\n        } else {\n          status = \"under\";\n        }\n\n        const message =\n          status === \"over\"\n            ? `Over budget in ${b.category} by ₹${spent - b.amount}`\n            : status === \"near\"\n            ? `Almost at budget in ${b.category} (₹${remaining} left)`\n            : `You're doing great in ${b.category} (₹${remaining} remaining)`;\n\n        return {\n          category: b.category,\n          status,\n          message,\n          spent,\n          budget: b.amount,\n        };\n      });\n\n      setInsights(results);\n      setLoading(false);\n    }\n\n    fetchData();\n  }, [refresh]);\n\n  if (loading) return null;\n\n  return (\n    <div className=\"bg-yellow-50 dark:bg-gray-800 border border-yellow-300 dark:border-yellow-500 rounded-lg p-6 mb-6 shadow-sm\">\n      <div className=\"flex items-center gap-2 mb-4\">\n        <AlertTriangle className=\"text-yellow-600 dark:text-yellow-400\" />\n        <h3 className=\"text-lg font-semibold text-yellow-800 dark:text-yellow-200\">\n          Spending Insights\n        </h3>\n      </div>\n\n      <ul className=\"space-y-4 text-sm\">\n        {insights.map((insight, i) => {\n          const { spent, budget, status, message } = insight;\n          const percent = Math.min((spent / budget) * 100, 100).toFixed(1);\n\n          let icon;\n          let bgColor = \"\";\n          let barColor = \"\";\n\n          if (status === \"over\") {\n            icon = <AlertTriangle className=\"w-4 h-4 text-red-600\" />;\n            bgColor = \"bg-red-100 dark:bg-red-800 border-red-300 dark:border-red-500\";\n            barColor = \"bg-red-500\";\n          } else if (status === \"near\") {\n            icon = <Hourglass className=\"w-4 h-4 text-yellow-500\" />;\n            bgColor = \"bg-yellow-100 dark:bg-yellow-800 border-yellow-300 dark:border-yellow-600\";\n            barColor = \"bg-yellow-400\";\n          } else {\n            icon = <CheckCircle className=\"w-4 h-4 text-green-600\" />;\n            bgColor = \"bg-green-100 dark:bg-green-900 border-green-300 dark:border-green-600\";\n            barColor = \"bg-green-500\";\n          }\n\n          return (\n            <li\n              key={i}\n              className={`p-3 border rounded ${bgColor}`}\n            >\n              <div className=\"flex items-center gap-2 mb-1 text-gray-800 dark:text-gray-100\">\n                {icon}\n                <span>{message}</span>\n              </div>\n\n              {/* Progress bar */}\n              <div className=\"w-full h-3 bg-gray-200 dark:bg-gray-700 rounded transition-all \">\n                <div\n                  className={`h-3 rounded ${barColor}  transition-all duration-700`}\n                  style={{ width: `${percent}%` }}\n                ></div>\n              </div>\n              <p className=\"text-xs text-right text-gray-600 dark:text-gray-300 mt-1\">\n                ₹{spent} spent of ₹{budget} ({percent}%)\n              </p>\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n","size_bytes":4353}},"version":2}